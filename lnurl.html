<link rel="stylesheet" href="https://spux.org/css/spux.css" />

<script type="application/ld+json" id="data">
  {
    "@id": "LNURL1DP68GURN8GHJ7MRWVF5HGUEWVDHK6TMHD96XSERJV9MJ7CTSDYHHVVF0D3H82UNV9AJKS5TXF34HGA64DFV5VU2HFE2RJ7PCW3E8Z0EQJRJ"
  }
</script>
<script type="module">
  import 'https://unpkg.com/dior'
  import { h, html, render, Component } from 'https://unpkg.com/spux?module'
  import bech32 from 'https://unpkg.com/lnurljs/bech32.js'
  import Navbar from 'https://unpkg.com/spux-components/Navbar.js'

  var address = qs.uri || di.data['@id'] || qs.uri

  var decoded = String.fromCharCode(
    ...bech32.fromWords(bech32.decode(address, 1000).words)
  )
  console.log(decoded)

  fetch(decoded)
    .then(response => response.json())
    .then(json => {
      globalThis.json = json
      console.log(json)

      render(
        html`
          <${Navbar} title="lnurl" />
          <div class="row">
            <h2>Bech32</h2>
            <div>${address}</div>
            <h2>Decoded</h2>
            <div>
              <a target="_blank" href="${decoded}">${decoded}</a>
            </div>
            <h2>JSON</h2>
            <pre>${JSON.stringify(json, null, 2)}</pre>
            <h2>Withdrawal</h2>

            To withdraw to a Payment Request (invoice). Take callback add k1=k1
            above pr=invoice
            <br />

            <a href="${json.callback + '?k1=' + json.k1 + '&pr='}"
              >${json.callback + '?k1=' + json.k1 + '&pr='}</a
            >
          </div>
        `,
        document.body
      )
    })
</script>
